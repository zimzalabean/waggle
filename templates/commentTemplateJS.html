{% macro comment_temp(comment, user_id) -%}

<style>
  .comment-wrap {
    max-width:100%;
    align-self: flex-end;
    background: none;
    /* border-radius:3px; */
    padding: 20px;
    border: none;
    /* border-bottom: 1px solid #e6ecf0;
    border-top: 1px solid #e6ecf0; */
  }
  .comment-wrap:hover {
    background-color: rgb(246, 246, 246);
}
  .comment-header {
    display: flex;
    align-items:flex-start;
    font-size:14px;
  }
  .avator-comment {
    width:40px;
    height:40px;
    margin-right: 15px;
    clip-path: circle(48px);
  }
  .img-profile{
    object-fit: cover;
    width: 100%;
    height: 100%;
    border-radius:50%;
  }
  
  .comment-header-info {
    font-family: 'Poppins', sans-serif;
  }
  .comment-header-info span commented-date {
    color:#657786;
    font-size:10px;
    margin-left: 20px;
  }
  
  .comment-img-wrap {
    padding-left: 60px;
    margin-top: 20px;
    margin-bottom: 20px;
  }
  
  .comment-info-counts {
    display: flex;
    align-items: center;
    margin-left: 60px;
    margin-top: 10px;
    border-top: #657786 1px;
  }
  .comment-info-counts div {
    display: flex;
    margin-right: 20px;
  }
  .comment-info-counts div button {
    color:#4b5b68;
    margin-right: 10px;
    background:none;
    border:none;
  }
  .comment-info-counts :hover {
    color:#a155bb;
  }

  .comment-info-counts div .selected {
    color:#9e47b8;
  }
  
  @media screen and (max-width:430px){
    body {
      padding-left: 20px;
      padding-right: 20px;
    }
    .comment-header {
      flex-direction:column;
    }
    .comment-header img {
      margin-bottom: 20px;
    }
    .comment-header-info p {
      margin-bottom: 30px;
      padding-left:20px;
    }
    .comment-img-wrap {
      min-height:20%;
      padding-left: 0;
    }
    .comment-info-counts {
    display: flex;
    margin-left: 0;
  }
  .comment-info-counts div {
    margin-right: 10px;
  }
}
</style>

<div class="comment-wrap">
    <div class="comment-header">
        <div class = 'avator-comment'>
          <img src="{{url_for('profilePic',user_id=comment.commentor_id)}}" alt="{{comment.commentor_id}}" class = 'img-profile'>
        </div>
      <div class="comment-header-info">
        <div><a href="{{url_for('user', username=comment.username)}}"><span class = 'author'> @{{comment.username}}</span></a> <span style = 'font-size: 10px;'> replied:</span></div>        
        <div><span class = 'posted-date'>{{comment.posted_date}}</span></div>
    </div>      
    </div>
    
    <div class="comment-img-wrap" onclick= "window.location.href = '{{url_for('addReply', comment_id=comment.comment_id)}}';">
      <p> {{comment.content}}</p>

    </div>

    <div class="comment-info-counts">
        
      <div class="comments">
        <button  onclick ="showReply('{{comment.comment_id}}')">
        <svg class="feather feather-message-circle sc-dnqmqq jxshSx" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg>
        </button>
        <div class="comment-count">{{comment.replies}}</div>
      </div>

      <form class = 'like-dislike-comment' method=comment action="{{url_for('likeComment')}}" >     

        <div class="likes">
          {% if comment.isLiked %}
          <button class = 'selected' id = 'comment-Like{{comment.comment_id}}' onclick ="likeComment('{{comment.comment_id}}','Unlike')">
            <svg class="feather feather-heart sc-dnqmqq jxshSx" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>
            </button>

          {% else %}
          <button id = 'comment-Like{{comment.comment_id}}' onclick ="likeComment('{{comment.comment_id}}','Like')">
            <svg class="feather feather-heart sc-dnqmqq jxshSx" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>
            </button>

          {% endif %}          
          <div><span id="comment-likes-count-{{comment.comment_id}}">{{comment.likes}}</span></div>
        </div> 

      </form>
     
      <div class="action">
        <button>
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-three-dots" viewBox="0 0 16 16">
            <path d="M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z"/>
          </svg>
        </button>
      </div>

    </div>
</div>
<div id="myDropdown_reply_{{comment.comment_id}}" class="dropdown-reply" style = 'padding-left:20px;'>   
    <form method='post' action="{{url_for('addReply', comment_id = comment.comment_id)}}" >     
      <div class = 'comment-header' style = 'align-items: center; '>
        <div class = 'avator-comment'>
            <img src="{{url_for('profilePic',user_id=user_id)}}" alt="{{user_id}}" class = 'img-profile'>    
        </div > 
        <div><input type ='text' class ='write-text' name="comment_content"  placeholder="Reply to this comment" ></div>
        <div><input type="submit" name="submit" class = 'search-filter' value="Reply"></div>
    </div>
    </form>
</div> 

<script>
    function showReply(cid) {
            event.preventDefault();
            document.getElementById("myDropdown_reply_"+cid).classList.toggle("showReply");
            console.log(document.getElementById("myDropdown_reply_"+cid));
        }


    function likeComment(comment_id, kind) {
        console.log(comment_id);
        console.log(kind);
        if (kind =='Like') {
          document.getElementById("comment-Like"+comment_id).classList.toggle("selected");
        }
        else if (kind == 'Unlike'){
            document.getElementById("comment-Like"+comment_id).classList.remove('selected');
        };         
        $.ajax({
                type: "POST",
                url: "/likeComment/",
                data: JSON.stringify({'comment_id': comment_id, 'kind': kind}),
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                async: true,
                success: function (resp) {
                    console.log(resp);
                    var comment_id = resp.comment_id;
                    var likes = resp.likes;
                    var dislikes = resp.dislikes;
                    console.log("New likes for comment "+comment_id+" is "+likes +" and new dislikes is "+dislikes);
                    $("#comment-likes-count-"+comment_id).text(likes);
                }
            });  event.preventDefault();
    }


</script>

{%- endmacro%}