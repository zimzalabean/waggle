{% macro comment_temp(comment, post) -%}
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
<link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Nunito+Sans&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@48,400,0,0" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<style>
    .material-symbols-outlined {
      font-size: 20px;
      font-variation-settings:
      'FILL' 0,
      'wght' 400,
      'GRAD' 0,
      'opsz' 48
    }

    .metric {
        padding: 0;
        margin: auto;
        border: none;
        background: none;
    }

    .metric-btn {
        font-size: 10px;
        border: none;
        background-color: none;
    }

    .metric-reply{
        /* display: flex;
        align-items: left; */
        font-size: 10px;
        border: none;
        background-color: none;
    }

    .metric-like{
        display: flex;
        align-items: center;
        font-size: 10px;
        border: none;
        background-color: none;
    }

    .metric-dislike {
        display: flex;
        align-items: right;
        font-size: 10px;
        border: none;
        background-color: none;        
    }

</style>

    <div class="comment" id="{{comment.comment_id}}" >
        <div class="container-comment">
            <div class="profile">
                <span class="material-symbols-rounded"> face_2 </span>     
            </div>
            <div class="comment-info" onclick= "window.location.href = '{{url_for('addReply', comment_id=comment.comment_id)}}#{{comment.comment_id}}';">
                <span><a href="{{url_for('user', username=comment.username)}}" class = "comment-author">{{comment.username}}</a></span> <span class = posted-date>{{comment.posted_date}} </span>
            </div>

            <div class="thread-block">
                {% if isThread %}
                <div class="thread-chain">
                </div>
                {% endif %}
            </div>

            <div class="comment-body">
                <div class="comment-content" onclick= "window.location.href = '{{url_for('addReply', comment_id=comment.comment_id)}}#{{comment.comment_id}}';">
                    {{comment.content}} 
                </div>

                <div>
                    <form form-cmt = "{{comment.comment_id}}" method='POST' id = "form-cmt-like" action="{{url_for('likeComment')}}" >
                            <button class ="metric-reply" onclick ="showReply('{{comment.comment_id}}')">
                                    <svg class="feather feather-message-circle sc-dnqmqq jxshSx" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg>
                                        </button><span id="replies-cnt-cmt-{{comment.comment_id}}" class="metric-num">{{comment.replies}}</span>       

                            <button class ="metric-btn" id = 'Like-{{comment.comment_id}}' name = "submit" value="Like" onclick ="likeComment('{{comment.comment_id}}','Like')">
                                    <span class="material-symbols-outlined">favorite</span>
                                </button> 
                                    <span id="likes-cnt-cmt-{{comment.comment_id}}" class="metric-num">{{comment.likes}}</span>


                            <button class ="metric-btn" id = 'Dislike-{{comment.comment_id}}' name = "submit" value="Dislike" onclick ="likeComment('{{comment.comment_id}}','Dislike')">
                                <span class="material-symbols-outlined">heart_broken</span>
                            </button> 
                                <span id="dislikes-cnt-cmt-{{comment.comment_id}}" class="metric-num">{{comment.dislikes}}</span>
                            <input type="hidden" name="post_id" value="{{post.post_id}}">
                            <input type="hidden" name="comment_id" value="{{comment.comment_id}}">
                        </form> 
                    </div>



                    <div id="myDropdown_reply_{{comment.comment_id}}" class="dropdown-reply">   
                        <form method='post' action="{{url_for('addReply', comment_id = comment.comment_id)}}" >     
                            <input type ='text' class ='reply-text-area' name="comment_content"  placeholder="Reply to comment" >
                            <input type="submit" name="submit" value="Reply">
                        </form>
                    </div> 
            </div>
        </div>
    </div>


<script>
    
    function showReply(cid) {
            event.preventDefault();
            // $(this).css("display","block");
            document.getElementById("myDropdown_reply_"+cid).classList.toggle("showReply");
            console.log(document.getElementById("myDropdown_reply_"+cid));
        }
    



    function likeComment(comment_id, kind) {
        console.log(comment_id);
        console.log(kind);
        // document.getElementById(kind+"-"+cid).classList.toggle("is-active");
        $.ajax({
                type: "POST",
                url: "/likeComment/",
                data: JSON.stringify({'comment_id': comment_id, 'kind': kind}),
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                async: true,
                success: function (resp) {
                    console.log(resp);
                    var comment_id = resp.comment_id;
                    var likes = resp.likes;
                    var dislikes = resp.dislikes;
                    console.log("New likes for comment "+comment_id+" is "+likes +" and new dislikes is "+dislikes);
                    $("#likes-cnt-cmt-"+comment_id).text(likes);
                    $("#dislikes-cnt-cmt-"+comment_id).text(dislikes);
                }
            // });  event.preventDefault();
    }

</script>

{%- endmacro%}